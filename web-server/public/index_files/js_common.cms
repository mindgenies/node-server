window._dash=window._dash||{};var in_all;var btncmnt;var btnfollowusr;var _tp_async_data={};var userInfo={};afterlogin();$(document).ready(function(){$(".commentclosebtn").click(function(){btncmnt=""})});function afterlogin(){if(GetCookie_nbt("ssoid")){$("#userloadingimg").show();$.ajax({url:"https://jsso.indiatimes.com/sso/crossdomain/getTicket?version=v1",dataType:"jsonp",success:function(a){var b=a.ticketId;$.ajax({url:"http://socialappsintegrator.indiatimes.com/socialsite/v1validateTicket?channel=nbt&ticketId="+b,dataType:"jsonp",success:function(e){createtopbar();
$("#userloadingimg").hide();userInfo.ssoId=GetCookie_nbt("ssoid");userInfo.emailId=GetCookie_nbt("MSCSAuthDetails").split("=")[1];if(userInfo.userEmailId.indexOf("@")==-1){userInfo.userEmailId=userEmailId+"@indiatimes.com"}_tp_async_data={host:"NBTO",channel:"News",URL:_tp_url,userId:userInfo.ssoId,email:userInfo.emailId};$("#timespointtab").attr("src","/timespointtab_frm.cms");try{timespointsapp.init()}catch(c){}iframereload("propertyframe")}})}})}else{createtopbar()}}function updateDomElement(b,c,d){d=d||false;
switch(true){case (b=="articleshow"||b=="articleshow_16"||b=="moviereview"||b=="techmobile")&&c=="login":userInfoconfig.loggedstatus=1;followwrite();if(btncmnt){postComment(btncmnt);btncmnt=""}if(btnfollowusr){followusr(btnfollowusr);$(".loginfollowbox").remove()}if(commentInfo.invokedLogin){feedbackComment(commentInfo.articleId,commentInfo.feedbackType,commentInfo.elementId,commentInfo.activityCount,commentInfo.objElement,commentInfo.userStatus)}if(commentInfo.abuseforminvoked&&commentInfo.formname){reportCommentAbusive(commentInfo.formname)
}try{if($("#newsletterform #emailid")){newsletter.isloggedin=getCookieNbt("MSCSAuthDetails");$("#newsletterform #emailid").val(d);$("#newsletterform #emailid").prop("disabled",true);newsletter.updateSubscriptionStatus()}}catch(a){console.log("login"+a)}break;case (b=="subscription"||b=="home")&&c=="login":if($("#newsletterform #emailid")){$("#newsletterform #emailid").val(d);$("#newsletterform #emailid").prop("disabled",true);$("#newsletterform .emailid").css("border","none");try{newsletter.updateSubscriptionStatus()
}catch(a){}}break;case (b=="subscription"||b=="articleshow")&&c=="logout":if($("#newsletterform #emailid")){$("#newsletterform #emailid").val("");$("#newsletterform #emailid").prop("disabled",false);$("#newsletterform input").prop("disabled",false)}break;default:}}function deletecookies(){DelCookie_nbt("FBOOK_ID","/",".indiatimes.com");DelCookie_nbt("FBOOK_NAME","/",".indiatimes.com");DelCookie_nbt("FBOOK_EMAIL","/",".indiatimes.com");DelCookie_nbt("FBOOK_LOCATION","/",".indiatimes.com");DelCookie_nbt("FBOOK_IMAGE","/",".indiatimes.com");
DelCookie_nbt("TWEET_ID","/",".indiatimes.com");DelCookie_nbt("TWEET_NAME","/",".indiatimes.com");DelCookie_nbt("TWEET_LOCATION","/",".indiatimes.com");DelCookie_nbt("TWEET_IMAGE","/",".indiatimes.com");DelCookie_nbt("articleid","/",".indiatimes.com");DelCookie_nbt("txtmsg","/",".indiatimes.com");DelCookie_nbt("tflocation","/",".indiatimes.com");DelCookie_nbt("tfemail","/",".indiatimes.com");DelCookie_nbt("setfocus","/",".indiatimes.com");DelCookie_nbt("fbcheck","/",".indiatimes.com");DelCookie_nbt("twtcheck","/",".indiatimes.com");
DelCookie_nbt("usercomt","/",".indiatimes.com");DelCookie_nbt("ifrmval","/",".indiatimes.com");DelCookie_nbt("frmbtm","/",".indiatimes.com");DelCookie_nbt("TicketId","/",".indiatimes.com");DelCookie_nbt("MSCSAuth","/",".indiatimes.com");DelCookie_nbt("MSCSAuthDetail","/",".indiatimes.com");DelCookie_nbt("MSCSAuthDetails","/",".indiatimes.com");DelCookie_nbt("MSCSAuthID","/",".indiatimes.com");DelCookie_nbt("ssoid","/",".indiatimes.com");DelCookie_nbt("fbOAuthId","/",".indiatimes.com");DelCookie_nbt("fbSecurityKey","/",".indiatimes.com");
DelCookie_nbt("fbimage","/",".indiatimes.com");DelCookie_nbt("fbname","/",".indiatimes.com");DelCookie_nbt("fbLocation","/",".indiatimes.com");DelCookie_nbt("gpbookname","/",".indiatimes.com");DelCookie_nbt("gpimage","/",".indiatimes.com");DelCookie_nbt("gpoauthid","/",".indiatimes.com");DelCookie_nbt("gpsecuritykey","/",".indiatimes.com");userInfo.ssoId="";btncmnt="";_tp_async_data={};if((document.location.toString().indexOf("articleshow")>0)||(document.location.toString().indexOf("moviereview"))>0){userInfoconfig.loggedstatus=0;
btncmnt=""}$("#timespointtab").attr("src","/timespointtab_frm.cms");try{timespointsapp.init()}catch(a){}}function removesession(){$.ajax({url:"https://jsso.indiatimes.com/sso/identity/profile/logout/external?channel=nbt",type:"GET",dataType:"jsonp",complete:function(){createtopbar();followwrite();$(".userloading").hide()}})}function logoutuser(){deletecookies();$(".userloading").show();removesession();commentInfo={};var b=document.location.pathname;var a=b=="/"?"home":(b.split(".cms")[0].split("/").length==2?b.split(".cms")[0].split("/")[1]:b.split(".cms")[0].split("/").slice(-2)[0]);
updateDomElement(a,"logout");iframereload("propertyframe")}function createtopbar(){try{var c="";if(GetCookie_nbt("ssoid")!=null){var d;var a=GetCookie_nbt("ssoid");$.ajax({dataType:"jsonp",url:"http://myt.indiatimes.com/mytimes/profile/info?ssoids="+a+"&callback=?",success:function(h){$("#apifstnameonly").html(h.F_N);$("#profileimg2").attr("src",h.thumb);try{userInfoconfig.fstname=h.F_N;userInfoconfig.fullname=h.FL_N;userInfoconfig.fstname=h.F_N;userInfoconfig.email=h.EMAIL;userInfoconfig.D_N_U=h.D_N_U;
userInfoconfig.sso=h.sso;userInfoconfig.city=h.CITY;userInfoconfig.loggedstatus=1;userInfoconfig._id=h._id;userInfoconfig.thumb=h.thumb;userInfoconfig.SIU=h.SIU}catch(f){}var g=document.location.pathname;var e=g=="/"?"home":(g.split(".cms")[0].split("/").length==2?g.split(".cms")[0].split("/")[1]:g.split(".cms")[0].split("/").slice(-2)[0]);var i=GetCookie_nbt("MSCSAuthDetails").split("=")[1];updateDomElement(e,"login",i)}});c='<div class="container_tpwid_loginheader"><div id="loginuser" class="loginuser Source_Sans"><div class="hoverdiv" style="position:relative;float:left;"><a href="https://jsso.indiatimes.com/sso/identity/profile/edit?channel=nbt" class="imgb" target="_blank"><img vspace="0" border="0" src="" id="profileimg2" alt="" title=""><span>Hi, <em id="apifstnameonly">&#160;</em><span class="dwnarrow"></span></span></a><ul class="loginnav"><li><a href="https://jsso.indiatimes.com/sso/identity/profile/edit?channel=nbt" target="_blank">Profile Settings</a></li><li><a href="http://mytimes.indiatimes.com/?channel=nbt" target="_blank">My Times</a></li><li><a href="javascript:logoutuser();" target="_top">Log Out</a></li></ul></div></div></div>';
c=c+'<img style="display:none;position:absolute;left:10px;top:0" width="15px" height="15px" src="/photo/35958799.cms" class="userloading" /><span>|</span>';document.getElementById("topbardiv").innerHTML=c}else{c+='<a href="javascript:opensso(\'login\');" class=newtop>Log In</a><img style="display:none;position:absolute;left:10px;top:0" width="15px" height="15px" id="userloadingimg" src="/photo/35958799.cms" class="userloading" /><span>|</span>';document.getElementById("topbardiv").innerHTML=c}$("#timespointtab").attr("src","/timespointtab_frm.cms");
try{timespointsapp.init()}catch(b){}}catch(b){}}function opensso(c){if(c=="Facebook"){ga("send","event","Facebook","click","LoginwtihFB");window.open("http://socialappsintegrator.indiatimes.com/socialsite/v1facebookrequest/nbt?type=login&channel=nbt","jsso","width=600,height=600")}if(c=="googleplus"){ga("send","event","googleplus","click","Loginwtihgplus");window.open("http://socialappsintegrator.indiatimes.com/socialsite/v1googleplusrequest/nbt?type=login&channel=nbt","jsso","width=600,height=600")
}if(c=="login"){ga("send","event","login","click","LoginFbTwOt");var a=window.open("https://jsso.indiatimes.com/sso/identity/login?channel=nbt","jsso","width=600,height=600");var b=setInterval(function(){if(a.closed&&!GetCookie_nbt("ssoid")){clearInterval(b);console.log("closed");commentInfo.invokedLogin=false}},500)}if(c=="join"){ga("send","event","NBT","click","Join");window.open("https://jsso.indiatimes.com/sso/identity/login?channel=nbt","jsso","width=600,height=600")}}function SetCookie_nbt(a,b){document.cookie=a+"="+escape(b)
}function GetCookie_nbt(c){var d=document.cookie.indexOf(c+"=");var a=d+c.length+1;if((!d)&&(c!=document.cookie.substring(0,c.length))){return null}if(d==-1){return null}var b=document.cookie.indexOf(";",a);if(b==-1){b=document.cookie.length}return unescape(document.cookie.substring(a,b))}function DelCookie_nbt(a,c,b){if(GetCookie_nbt(a)){document.cookie=a+"="+((c)?";path="+c:"")+((b)?";domain="+b:"")+";expires=Thu, 01-Jan-1970 00:00:01 GMT"}}function chromeversion(){var a=navigator.appVersion;if(a.indexOf("Chrome")>-1){a=a.substring(a.indexOf("Chrome"),a.length);
a=a.split("/");a=a[1].split(".");if(a[0]>=42){$(".desktopalert").show()}}}chromeversion();function iframereload(b){try{var c=$("#"+b).attr("src");$("#"+b).attr("src",c)}catch(a){}};